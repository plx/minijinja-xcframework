From 3531a5461a613d924dde5ba3fb9a844a2ef4439f Mon Sep 17 00:00:00 2001
From: Claude <noreply@anthropic.com>
Date: Wed, 22 Oct 2025 15:44:42 +0000
Subject: [PATCH] Update CI workflow to use just instead of bash script

Replace direct bash script invocation with just commands:
- Install just using extractions/setup-just@v2
- Remove explicit Rust target installation (handled by justfile)
- Run 'just build' with MINIJINJA_VERSION environment variable

Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>
---
 .github/workflows/build-release.yml | 37 +++++------------------------
 1 file changed, 6 insertions(+), 31 deletions(-)

diff --git a/.github/workflows/build-release.yml b/.github/workflows/build-release.yml
index 7d03296..850c561 100644
--- a/.github/workflows/build-release.yml
+++ b/.github/workflows/build-release.yml
@@ -54,35 +54,10 @@ jobs:
       
       - name: Setup Rust
         uses: dtolnay/rust-toolchain@stable
-        with:
-          targets: |
-            # iOS
-            aarch64-apple-ios
-            x86_64-apple-ios
-            aarch64-apple-ios-sim
-
-            # Catalyst
-            aarch64-apple-ios-macabi
-            x86_64-apple-ios-macabi
-
-            # tvOS
-            aarch64-apple-tvos
-            x86_64-apple-tvos
-            aarch64-apple-tvos-sim
-
-            # watchOS
-            aarch64-apple-watchos
-            aarch64-apple-watchos-sim
-            x86_64-apple-watchos-sim
 
-            # macOS
-            aarch64-apple-darwin
-            x86_64-apple-darwin
+      - name: Install just
+        uses: extractions/setup-just@v2
 
-            # visionOS
-            aarch64-apple-visionos
-            aarch64-apple-visionos-sim
-      
       - name: Determine version
         id: version
         run: |
@@ -95,11 +70,11 @@ jobs:
             VERSION="${{ needs.check-release.outputs.version }}"
           fi
           echo "version=$VERSION" >> $GITHUB_OUTPUT
-      
+
       - name: Build XCFramework
-        run: |
-          chmod +x scripts/build-xcframework.sh
-          ./scripts/build-xcframework.sh ${{ steps.version.outputs.version }}
+        run: just build
+        env:
+          MINIJINJA_VERSION: ${{ steps.version.outputs.version }}
       
       - name: Upload artifacts
         uses: actions/upload-artifact@v4
-- 
2.43.0

